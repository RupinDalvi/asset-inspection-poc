{"ast":null,"code":"import React,{useRef,useState,useContext}from'react';import{calculateMagnitude,classifyVibration}from'../services/vibration';import{InspectionContext}from'../contexts/InspectionContext';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function VibrationAnalysis(){const canvasRef=useRef();const[running,setRunning]=useState(false);const{setVibrationResult,setRawVibrationData}=useContext(InspectionContext);const start=()=>{const data=[];const ctx=canvasRef.current.getContext('2d');const{width,height}=canvasRef.current;ctx.clearRect(0,0,width,height);let count=0,max=100;const handler=ev=>{const{x,y,z}=ev.accelerationIncludingGravity;const mag=calculateMagnitude({x,y,z});data.push({x,y,z,magnitude:mag,timestamp:Date.now()});ctx.fillRect(count/max*width,height-mag/20*height,2,2);if(++count>=max){window.removeEventListener('devicemotion',handler);const res=classifyVibration(data);setRawVibrationData(data);setVibrationResult(res);setRunning(false);}};window.addEventListener('devicemotion',handler);setRunning(true);};return/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-medium mb-1\",children:\"Vibration Analysis\"}),/*#__PURE__*/_jsx(\"button\",{onClick:start,disabled:running,className:\"bg-indigo-500 text-white px-3 py-1 rounded mb-2\",children:running?'Analyzing...':'Start Vibration Analysis'}),/*#__PURE__*/_jsx(\"canvas\",{ref:canvasRef,width:300,height:100,className:\"border\"})]});}","map":{"version":3,"names":["React","useRef","useState","useContext","calculateMagnitude","classifyVibration","InspectionContext","jsx","_jsx","jsxs","_jsxs","VibrationAnalysis","canvasRef","running","setRunning","setVibrationResult","setRawVibrationData","start","data","ctx","current","getContext","width","height","clearRect","count","max","handler","ev","x","y","z","accelerationIncludingGravity","mag","push","magnitude","timestamp","Date","now","fillRect","window","removeEventListener","res","addEventListener","className","children","onClick","disabled","ref"],"sources":["C:/Development/VibeVibes/IP/apps/inspection-app/src/components/VibrationAnalysis.js"],"sourcesContent":["import React, { useRef, useState, useContext } from 'react';\nimport { calculateMagnitude, classifyVibration } from '../services/vibration';\nimport { InspectionContext } from '../contexts/InspectionContext';\nexport default function VibrationAnalysis() {\n  const canvasRef = useRef();\n  const [running,setRunning]=useState(false);\n  const { setVibrationResult, setRawVibrationData } = useContext(InspectionContext);\n  const start = () => {\n    const data=[];\n    const ctx=canvasRef.current.getContext('2d');\n    const { width, height } = canvasRef.current;\n    ctx.clearRect(0,0,width,height);\n    let count=0, max=100;\n    const handler=ev=>{\n      const {x,y,z}=ev.accelerationIncludingGravity;\n      const mag=calculateMagnitude({x,y,z});\n      data.push({x,y,z,magnitude:mag,timestamp:Date.now()});\n      ctx.fillRect((count/max)*width, height-(mag/20)*height,2,2);\n      if(++count>=max){ window.removeEventListener('devicemotion',handler);\n        const res=classifyVibration(data);\n        setRawVibrationData(data);\n        setVibrationResult(res);\n        setRunning(false);\n      }};\n    window.addEventListener('devicemotion',handler);\n    setRunning(true);\n  };\n  return (<div className=\"mb-4\">\n    <h3 className=\"font-medium mb-1\">Vibration Analysis</h3>\n    <button onClick={start} disabled={running} className=\"bg-indigo-500 text-white px-3 py-1 rounded mb-2\">\n      {running?'Analyzing...':'Start Vibration Analysis'}\n    </button>\n    <canvas ref={canvasRef} width={300} height={100} className=\"border\" />\n  </div>);\n}\n\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,MAAM,CAAEC,QAAQ,CAAEC,UAAU,KAAQ,OAAO,CAC3D,OAASC,kBAAkB,CAAEC,iBAAiB,KAAQ,uBAAuB,CAC7E,OAASC,iBAAiB,KAAQ,+BAA+B,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAClE,cAAe,SAAS,CAAAC,iBAAiBA,CAAA,CAAG,CAC1C,KAAM,CAAAC,SAAS,CAAGX,MAAM,CAAC,CAAC,CAC1B,KAAM,CAACY,OAAO,CAACC,UAAU,CAAC,CAACZ,QAAQ,CAAC,KAAK,CAAC,CAC1C,KAAM,CAAEa,kBAAkB,CAAEC,mBAAoB,CAAC,CAAGb,UAAU,CAACG,iBAAiB,CAAC,CACjF,KAAM,CAAAW,KAAK,CAAGA,CAAA,GAAM,CAClB,KAAM,CAAAC,IAAI,CAAC,EAAE,CACb,KAAM,CAAAC,GAAG,CAACP,SAAS,CAACQ,OAAO,CAACC,UAAU,CAAC,IAAI,CAAC,CAC5C,KAAM,CAAEC,KAAK,CAAEC,MAAO,CAAC,CAAGX,SAAS,CAACQ,OAAO,CAC3CD,GAAG,CAACK,SAAS,CAAC,CAAC,CAAC,CAAC,CAACF,KAAK,CAACC,MAAM,CAAC,CAC/B,GAAI,CAAAE,KAAK,CAAC,CAAC,CAAEC,GAAG,CAAC,GAAG,CACpB,KAAM,CAAAC,OAAO,CAACC,EAAE,EAAE,CAChB,KAAM,CAACC,CAAC,CAACC,CAAC,CAACC,CAAC,CAAC,CAACH,EAAE,CAACI,4BAA4B,CAC7C,KAAM,CAAAC,GAAG,CAAC7B,kBAAkB,CAAC,CAACyB,CAAC,CAACC,CAAC,CAACC,CAAC,CAAC,CAAC,CACrCb,IAAI,CAACgB,IAAI,CAAC,CAACL,CAAC,CAACC,CAAC,CAACC,CAAC,CAACI,SAAS,CAACF,GAAG,CAACG,SAAS,CAACC,IAAI,CAACC,GAAG,CAAC,CAAC,CAAC,CAAC,CACrDnB,GAAG,CAACoB,QAAQ,CAAEd,KAAK,CAACC,GAAG,CAAEJ,KAAK,CAAEC,MAAM,CAAEU,GAAG,CAAC,EAAE,CAAEV,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAC3D,GAAG,EAAEE,KAAK,EAAEC,GAAG,CAAC,CAAEc,MAAM,CAACC,mBAAmB,CAAC,cAAc,CAACd,OAAO,CAAC,CAClE,KAAM,CAAAe,GAAG,CAACrC,iBAAiB,CAACa,IAAI,CAAC,CACjCF,mBAAmB,CAACE,IAAI,CAAC,CACzBH,kBAAkB,CAAC2B,GAAG,CAAC,CACvB5B,UAAU,CAAC,KAAK,CAAC,CACnB,CAAC,CAAC,CACJ0B,MAAM,CAACG,gBAAgB,CAAC,cAAc,CAAChB,OAAO,CAAC,CAC/Cb,UAAU,CAAC,IAAI,CAAC,CAClB,CAAC,CACD,mBAAQJ,KAAA,QAAKkC,SAAS,CAAC,MAAM,CAAAC,QAAA,eAC3BrC,IAAA,OAAIoC,SAAS,CAAC,kBAAkB,CAAAC,QAAA,CAAC,oBAAkB,CAAI,CAAC,cACxDrC,IAAA,WAAQsC,OAAO,CAAE7B,KAAM,CAAC8B,QAAQ,CAAElC,OAAQ,CAAC+B,SAAS,CAAC,iDAAiD,CAAAC,QAAA,CACnGhC,OAAO,CAAC,cAAc,CAAC,0BAA0B,CAC5C,CAAC,cACTL,IAAA,WAAQwC,GAAG,CAAEpC,SAAU,CAACU,KAAK,CAAE,GAAI,CAACC,MAAM,CAAE,GAAI,CAACqB,SAAS,CAAC,QAAQ,CAAE,CAAC,EACnE,CAAC,CACR","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}