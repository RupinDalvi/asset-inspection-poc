{"ast":null,"code":"var _jsxFileName = \"C:\\\\Development\\\\VibeVibes\\\\IP\\\\apps\\\\inspection-app\\\\src\\\\components\\\\MediaCapture.js\",\n  _s = $RefreshSig$();\nimport React, { useRef, useState, useEffect, useContext } from 'react';\nimport { InspectionContext } from '../contexts/InspectionContext';\nimport { getCurrentPosition } from '../services/geolocation';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function MediaCapture() {\n  _s();\n  const videoRef = useRef();\n  const recorderRef = useRef();\n  const [recording, setRecording] = useState(false);\n  const {\n    photos,\n    setPhotos,\n    videos,\n    setVideos\n  } = useContext(InspectionContext);\n  useEffect(() => {\n    (async () => {\n      try {\n        const stream = await navigator.mediaDevices.getUserMedia({\n          video: true,\n          audio: true\n        });\n        videoRef.current.srcObject = stream;\n        recorderRef.current = new MediaRecorder(stream);\n        recorderRef.current.ondataavailable = async e => {\n          const blob = e.data;\n          let pos;\n          try {\n            pos = await getCurrentPosition();\n          } catch {\n            pos = {\n              coords: null,\n              timestamp: Date.now()\n            };\n          }\n          const url = URL.createObjectURL(blob);\n          setVideos(v => [...v, {\n            blob,\n            location: pos.coords,\n            timestamp: pos.timestamp,\n            url\n          }]);\n        };\n      } catch (err) {\n        console.error(err);\n      }\n    })();\n    return () => {\n      var _videoRef$current, _videoRef$current$src;\n      return (_videoRef$current = videoRef.current) === null || _videoRef$current === void 0 ? void 0 : (_videoRef$current$src = _videoRef$current.srcObject) === null || _videoRef$current$src === void 0 ? void 0 : _videoRef$current$src.getTracks().forEach(t => t.stop());\n    };\n  }, []);\n  const takePhoto = () => {\n    const video = videoRef.current;\n    const canvas = document.createElement('canvas');\n    canvas.width = video.videoWidth;\n    canvas.height = video.videoHeight;\n    canvas.getContext('2d').drawImage(video, 0, 0);\n    canvas.toBlob(async blob => {\n      let pos;\n      try {\n        pos = await getCurrentPosition();\n      } catch {\n        pos = {\n          coords: null,\n          timestamp: Date.now()\n        };\n      }\n      const url = URL.createObjectURL(blob);\n      setPhotos(p => [...p, {\n        blob,\n        location: pos.coords,\n        timestamp: pos.timestamp,\n        url\n      }]);\n    }, 'image/jpeg');\n  };\n  const toggleRec = () => {\n    if (recording) {\n      recorderRef.current.stop();\n      setRecording(false);\n    } else {\n      recorderRef.current.start();\n      setRecording(true);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"mb-4\",\n    children: [/*#__PURE__*/_jsxDEV(\"video\", {\n      ref: videoRef,\n      autoPlay: true,\n      muted: true,\n      className: \"w-full max-w-md mb-2 rounded shadow\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-x-2\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: takePhoto,\n        className: \"bg-green-500 text-white px-3 py-1 rounded\",\n        children: \"Take Photo\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 47,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: toggleRec,\n        className: \"bg-yellow-500 text-white px-3 py-1 rounded\",\n        children: recording ? 'Stop Recording' : 'Record Video'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-2 flex space-x-2 overflow-x-auto\",\n      children: [photos.map((p, i) => /*#__PURE__*/_jsxDEV(\"img\", {\n        src: p.url,\n        className: \"w-20 h-20 object-cover rounded\"\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 53,\n        columnNumber: 30\n      }, this)), videos.map((v, i) => /*#__PURE__*/_jsxDEV(\"video\", {\n        src: v.url,\n        controls: true,\n        className: \"w-20 h-20 rounded\"\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 54,\n        columnNumber: 30\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 44,\n    columnNumber: 5\n  }, this);\n}\n_s(MediaCapture, \"lxCt6Ox40NAejUhIzRG8tLhZbWQ=\");\n_c = MediaCapture;\nvar _c;\n$RefreshReg$(_c, \"MediaCapture\");","map":{"version":3,"names":["React","useRef","useState","useEffect","useContext","InspectionContext","getCurrentPosition","jsxDEV","_jsxDEV","MediaCapture","_s","videoRef","recorderRef","recording","setRecording","photos","setPhotos","videos","setVideos","stream","navigator","mediaDevices","getUserMedia","video","audio","current","srcObject","MediaRecorder","ondataavailable","e","blob","data","pos","coords","timestamp","Date","now","url","URL","createObjectURL","v","location","err","console","error","_videoRef$current","_videoRef$current$src","getTracks","forEach","t","stop","takePhoto","canvas","document","createElement","width","videoWidth","height","videoHeight","getContext","drawImage","toBlob","p","toggleRec","start","className","children","ref","autoPlay","muted","fileName","_jsxFileName","lineNumber","columnNumber","onClick","map","i","src","controls","_c","$RefreshReg$"],"sources":["C:/Development/VibeVibes/IP/apps/inspection-app/src/components/MediaCapture.js"],"sourcesContent":["import React, { useRef, useState, useEffect, useContext } from 'react';\nimport { InspectionContext } from '../contexts/InspectionContext';\nimport { getCurrentPosition } from '../services/geolocation';\nexport default function MediaCapture() {\n  const videoRef = useRef();\n  const recorderRef = useRef();\n  const [recording, setRecording] = useState(false);\n  const { photos, setPhotos, videos, setVideos } = useContext(InspectionContext);\n  useEffect(() => {\n    (async () => {\n      try {\n        const stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });\n        videoRef.current.srcObject = stream;\n        recorderRef.current = new MediaRecorder(stream);\n        recorderRef.current.ondataavailable = async e => {\n          const blob = e.data;\n          let pos;\n          try { pos = await getCurrentPosition(); } catch { pos = { coords: null, timestamp: Date.now() }; }\n          const url = URL.createObjectURL(blob);\n          setVideos(v => [...v, { blob, location: pos.coords, timestamp: pos.timestamp, url }]);\n        };\n      } catch (err) { console.error(err); }\n    })();\n    return () => videoRef.current?.srcObject?.getTracks().forEach(t => t.stop());\n  }, []);\n\n  const takePhoto = () => {\n    const video = videoRef.current;\n    const canvas = document.createElement('canvas');\n    canvas.width = video.videoWidth; canvas.height = video.videoHeight;\n    canvas.getContext('2d').drawImage(video,0,0);\n    canvas.toBlob(async blob => {\n      let pos;\n      try { pos = await getCurrentPosition(); } catch { pos={coords:null,timestamp:Date.now()}; }\n      const url = URL.createObjectURL(blob);\n      setPhotos(p => [...p, { blob, location: pos.coords, timestamp: pos.timestamp, url }]);\n    }, 'image/jpeg');\n  };\n  const toggleRec = () => {\n    if (recording) { recorderRef.current.stop(); setRecording(false); }\n    else { recorderRef.current.start(); setRecording(true); }\n  };\n  return (\n    <div className=\"mb-4\">\n      <video ref={videoRef} autoPlay muted className=\"w-full max-w-md mb-2 rounded shadow\" />\n      <div className=\"space-x-2\">\n        <button onClick={takePhoto} className=\"bg-green-500 text-white px-3 py-1 rounded\">Take Photo</button>\n        <button onClick={toggleRec} className=\"bg-yellow-500 text-white px-3 py-1 rounded\">\n          {recording ? 'Stop Recording' : 'Record Video'}\n        </button>\n      </div>\n      <div className=\"mt-2 flex space-x-2 overflow-x-auto\">\n        {photos.map((p,i) => <img key={i} src={p.url} className=\"w-20 h-20 object-cover rounded\" />)}\n        {videos.map((v,i) => <video key={i} src={v.url} controls className=\"w-20 h-20 rounded\" />)}\n      </div>\n    </div>\n  );\n}\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}